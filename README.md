# Практического задание python

## Задание

Необходимо написать очень простой поисковик по текстам документов. Данные хранятся в БД по желанию, поисковый индекс в эластике.
Ссылка на тестовый массива данных: ./posts.csv.

__Структура БД:__

- `id` - уникальный для каждого документа;
- `rubrics` - массив рубрик;
- `text` - текст документа;
- `created_date` - дата создания документа.


__Структура Индекса:__

- `iD` - id из базы;
- `text` - текст из структуры БД.


__Необходимые методы:__

- сервис должен принимать на вход произвольный текстовый запрос, искать по тексту документа в индексе и возвращать первые 20 документов со всем полями БД, упорядоченные по дате создания;
- удалять документ из БД и индекса по полю  `id`.

__Технические требования:__

- любой python фреймворк кроме Django и DRF;
- `README` с гайдом по поднятию;
- `docs.json` - документация к сервису в формате openapi.

__Программа максимум:__

- функциональные тесты;
- сервис работает в Docker;
- асинхронные вызовы.


---



# Простой текстовый поисковик

Этот проект представляет собой простой текстовый поисковик, который использует SQLite для хранения данных и Elasticsearch для индексации и поиска текста.

## Подготовка к запуску

### Установка зависимостей

Следует убедиться, что установлены все необходимые зависимости. Если нет, можно установить их с помощью pip:

```bash
pip install -r requirements.txt
```

### Запуск Elasticsearch

Для запуска Elasticsearch следует выполнить следующую команду:

```bash
./bin/elasticsearch
```

### Инициализация базы данных

Для инициализации базы данных следует выполнить скрипт `database.py`. Этот скрипт преобразует данные из файла `posts.csv` и заносит их в базу данных SQLite (`database.db`):

```bash
python database.py
```

### Индексация данных в Elasticsearch

Для индексации данных в Elasticsearch следует выполнить скрипт `my_elasticsearch.py`. Этот скрипт создает индекс “note” и вносит данные из `database.db`:

```bash
python my_elasticsearch.py
```

### Запуск сервера

После того, как база данных и Elasticsearch были инициализированы, можно запустить сервер, выполнив скрипт `main.py` с помощью uvicorn:

```bash
uvicorn main:app --reload
```

Теперь сервер должен быть доступен по адресу `http://127.0.0.1:8000`.

### Использование сервиса

Сервис предоставляет два конечных пункта:

- `GET /search/{text}`: принимает на вход произвольный текстовый запрос, ищет по тексту документа в индексе и возвращает первые 20 документов со всеми полями БД, упорядоченные по дате создания.
- `DELETE /delete/{id}`: удаляет документ из БД и индекса по полю id.

### Примечания

- В файле `passw` в переменной `password` хранится пароль к Elasticsearch. Следует убедиться, что установлен правильный пароль перед запуском сервиса.


